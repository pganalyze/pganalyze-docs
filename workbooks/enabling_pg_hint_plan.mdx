---
title: 'Enabling pg_hint_plan'
backlink_href: /docs/query-tuning
backlink_title: 'Query Tuning'
---

`pg_hint_plan` is a PostgreSQL extension that offers the possibility to tweak
PostgreSQL execution plans using so-called "hints" in SQL comments.

This can help you guide the planner to pick or avoid specific execution plans,
which is useful for tuning queries.

## Installing and enabling (Self-managed)

For self-managed servers, install `pg_hint_plan` either by building a binary
module from the code, or from a binary package for Debian or Ubuntu.
Below is an example of installing `pg_hint_plan` from a binary package:

<CodeBlock language="bash">
{`sudo apt install postgresql-<postgres version>-pg-hint-plan`}
</CodeBlock>

You don't need to run `CREATE EXTENSION` for `pg_hint_plan` unless you plan to
use the hint table (in most cases, you won't need it).
You can load it with the `LOAD` command (for the current session), or via
`shared_preload_libraries` (to enable it globally).

<CodeBlock language="bash">
{`LOAD 'pg_hint_plan';`}
</CodeBlock>

## Installing and enabling (Cloud providers)

For the cloud providers, the extension is usually available so you don't need to
do a special thing to install.

To enable `pg_hint_plan`, each provider has slightly different ways, however the
basic flow is the same. Add it in `shared_preload_libraries`, restart, then run
`CREATE EXTENSION pg_hint_plan;`.

### Amazon RDS for PostgreSQL or Amazon Aurora PostgreSQL

* Add `pg_hint_plan` to the `shared_preload_libraries` by tweaking the parameter
group
  * See the [the troubleshooting document about pg_stat_statements](/docs/install/troubleshooting/rds_pg_stat_statements_shared_preload_libraries)
    for how to tweak the parameter group
* Restart the instance to apply the change
* Run `CREATE EXTENSION pg_hint_plan;`

### Google Cloud SQL

* Set the `cloudsql.enable_pg_hint_plan` flag to `on`
  * See [Configure database flags](https://cloud.google.com/sql/docs/postgres/flags)
    Google Cloud SQL documentation for how to set flags
* Save the change and restart (automatically triggered as the change requires restart)
* For Google Cloud SQL, no need to run `CREATE EXTENSION`

### Azure Database for PostgreSQL

* Enable `PG_HINT_PLAN` in the Server Parameters page
  * See [Enabling pg_stat_statements](/docs/install/azure_database/01_configure_azure_instance#enabling-pg_stat_statements)
    section for how to tweak the server parameters
* Restart the instance to apply the change
* Run `CREATE EXTENSION pg_hint_plan;`
